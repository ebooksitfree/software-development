![Cover image for Spring Security in Action](https://imgdetail.ebookreading.net/cover/cover/20201212/EB9781617297731.jpg)

[Spring Security in Action](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_1.html "Spring Security in Action")
====================================================================================================================

Author : [Laurentiu Spilca](https://ebookreading.net/search/author/Laurentiu+Spilca)

Release Date : 2020/10/01

Book Description
-----------------


    
    Spring Security in Action shows you how to prevent cross-site scripting and request forgery attacks before they do damage. Youâ€™ll start with the basics, simulating password upgrades and adding multiple types of authorization. As your skills grow, you'll adapt Spring Security to new architectures and create advanced OAuth2 configurations. By the time you're done, you'll have a customized Spring Security configuration that protects against threats both common and extraordinary.
  
  
  

Table of Contents
-----------------

1. [Spring Security in Action](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_2.html)
1. [Copyright](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_3.html)
1. [contents](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_4.html)
1. [front matter](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_5.html)
    1. [foreword](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_5.html#heading_id_3)
    1. [preface](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_5.html#heading_id_4)
    1. [acknowledgments](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_5.html#heading_id_5)
    1. [about this book](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_5.html#heading_id_6)
        1. [Who should read this book?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_5.html#heading_id_7)
        1. [How this book is organized: A roadmap](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_5.html#heading_id_8)
        1. [About the code](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_5.html#heading_id_9)
        1. [The liveBook discussion forum](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_5.html#heading_id_10)
        1. [Other online resources](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_5.html#heading_id_11)
    1. [about the author](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_5.html#heading_id_12)
    1. [about the cover illustration](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_5.html#heading_id_13)
1. [Part 1. First Steps](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_6.html)
1. [1 Security today](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html)
    1. [1.1 Spring Security: The what and the why](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_3)
    1. [1.2 What is software security?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_4)
    1. [1.3 Why is security important?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_5)
    1. [1.4 Common security vulnerabilities in web applications](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_6)
        1. [1.4.1 Vulnerabilities in authentication and authorization](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_7)
        1. [1.4.2 What is session fixation?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_8)
        1. [1.4.3 What is cross-site scripting (XSS)?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_9)
        1. [1.4.4 What is cross-site request forgery (CSRF)?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_10)
        1. [1.4.5 Understanding injection vulnerabilities in web applications](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_11)
        1. [1.4.6 Dealing with the exposure of sensitive data](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_12)
        1. [1.4.7 What is the lack of method access control?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_13)
        1. [1.4.8 Using dependencies with known vulnerabilities](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_14)
    1. [1.5 Security applied in various architectures](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_15)
        1. [1.5.1 Designing a one-piece web application](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_16)
        1. [1.5.2 Designing security for a backend/frontend separation](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_17)
        1. [1.5.3 Understanding the OAuth 2 flow](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_18)
        1. [1.5.4 Using API keys, cryptographic signatures, and IP validation to secure requests](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_19)
    1. [1.6 What will you learn in this book?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_20)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_7.html#heading_id_21)
1. [2 Hello Spring Security](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_8.html)
    1. [2.1 Starting with the first project](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_8.html#heading_id_3)
    1. [2.2 Which are the default configurations?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_8.html#heading_id_4)
    1. [2.3 Overriding default configurations](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_8.html#heading_id_5)
        1. [2.3.1 Overriding the UserDetailsService component](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_8.html#heading_id_6)
        1. [2.3.2 Overriding the endpoint authorization configuration](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_8.html#heading_id_7)
        1. [2.3.3 Setting the configuration in different ways](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_8.html#heading_id_8)
        1. [2.3.4 Overriding the AuthenticationProvider implementation](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_8.html#heading_id_9)
        1. [2.3.5 Using multiple configuration classes in your project](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_8.html#heading_id_10)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_8.html#heading_id_11)
1. [Part 2. Implementation](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_9.html)
1. [3 Managing users](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html)
    1. [3.1 Implementing authentication in Spring Security](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_3)
    1. [3.2 Describing the user](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_4)
        1. [3.2.1 Demystifying the definition of the UserDetails contract](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_5)
        1. [3.2.2 Detailing on the GrantedAuthority contract](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_6)
        1. [3.2.3 Writing a minimal implementation of UserDetails](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_7)
        1. [3.2.4 Using a builder to create instances of the UserDetails type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_8)
        1. [3.2.5 Combining multiple responsibilities related to the user](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_9)
    1. [3.3 Instructing Spring Security on how to manage users](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_10)
        1. [3.3.1 Understanding the UserDetailsService contract](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_11)
        1. [3.3.2 Implementing the UserDetailsService contract](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_12)
        1. [3.3.3 Implementing the UserDetailsManager contract](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_13)
            1. [Using a JdbcUserDetailsManager for user management](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_14)
            1. [Using an LdapUserDetailsManager for user management](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_15)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_10.html#heading_id_16)
1. [4 Dealing with passwords](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_11.html)
    1. [4.1 Understanding the PasswordEncoder contract](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_11.html#heading_id_3)
        1. [4.1.1 The definition of the PasswordEncoder contract](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_11.html#heading_id_4)
        1. [4.1.2 Implementing the PasswordEncoder contract](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_11.html#heading_id_5)
        1. [4.1.3 Choosing from the provided implementations of PasswordEncoder](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_11.html#heading_id_6)
        1. [4.1.4 Multiple encoding strategies with DelegatingPasswordEncoder](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_11.html#heading_id_7)
    1. [4.2 More about the Spring Security Crypto module](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_11.html#heading_id_8)
        1. [4.2.1 Using key generators](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_11.html#heading_id_9)
        1. [4.2.2 Using encryptors for encryption and decryption operations](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_11.html#heading_id_10)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_11.html#heading_id_11)
1. [5 Implementing authentication](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html)
    1. [5.1 Understanding the AuthenticationProvider](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_3)
        1. [5.1.1 Representing the request during authentication](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_4)
        1. [5.1.2 Implementing custom authentication logic](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_5)
        1. [5.1.3 Applying custom authentication logic](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_6)
    1. [5.2 Using the SecurityContext](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_7)
        1. [5.2.1 Using a holding strategy for the security context](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_8)
        1. [5.2.2 Using a holding strategy for asynchronous calls](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_9)
        1. [5.2.3 Using a holding strategy for standalone applications](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_10)
        1. [5.2.4 Forwarding the security context with DelegatingSecurityContextRunnable](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_11)
        1. [5.2.5 Forwarding the security context with DelegatingSecurityContextExecutorService](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_12)
    1. [5.3 Understanding HTTP Basic and form-based login authentications](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_13)
        1. [5.3.1 Using and configuring HTTP Basic](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_14)
        1. [5.3.2 Implementing authentication with form-based login](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_15)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_12.html#heading_id_16)
1. [6 Hands-on: A small secured web application](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_13.html)
    1. [6.1 Project requirements and setup](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_13.html#heading_id_3)
    1. [6.2 Implementing user management](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_13.html#heading_id_4)
    1. [6.3 Implementing custom authentication logic](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_13.html#heading_id_5)
    1. [6.4 Implementing the main page](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_13.html#heading_id_6)
    1. [6.5 Running and testing the application](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_13.html#heading_id_7)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_13.html#heading_id_8)
1. [7 Configuring authorization: Restricting access](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_14.html)
    1. [7.1 Restricting access based on authorities and roles](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_14.html#heading_id_3)
        1. [7.1.1 Restricting access for all endpoints based on user authorities](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_14.html#heading_id_4)
        1. [7.1.2 Restricting access for all endpoints based on user roles](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_14.html#heading_id_5)
        1. [7.1.3 Restricting access to all endpoints](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_14.html#heading_id_6)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_14.html#heading_id_7)
1. [8 Configuring authorization: Applying restrictions](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_15.html)
    1. [8.1 Using matcher methods to select endpoints](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_15.html#heading_id_3)
    1. [8.2 Selecting requests for authorization using MVC matchers](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_15.html#heading_id_4)
    1. [8.3 Selecting requests for authorization using Ant matchers](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_15.html#heading_id_5)
    1. [8.4 Selecting requests for authorization using regex matchers](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_15.html#heading_id_6)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_15.html#heading_id_7)
1. [9 Implementing filters](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_16.html)
    1. [9.1 Implementing filters in the Spring Security architecture](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_16.html#heading_id_3)
    1. [9.2 Adding a filter before an existing one in the chain](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_16.html#heading_id_4)
    1. [9.3 Adding a filter after an existing one in the chain](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_16.html#heading_id_5)
    1. [9.4 Adding a filter at the location of another in the chain](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_16.html#heading_id_6)
    1. [9.5 Filter implementations provided by Spring Security](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_16.html#heading_id_7)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_16.html#heading_id_8)
1. [10 Applying CSRF protection and CORS](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_17.html)
    1. [10.1 Applying cross-site request forgery (CSRF) protection in applications](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_17.html#heading_id_3)
        1. [10.1.1 How CSRF protection works in Spring Security](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_17.html#heading_id_4)
        1. [10.1.2 Using CSRF protection in practical scenarios](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_17.html#heading_id_5)
        1. [10.1.3 Customizing CSRF protection](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_17.html#heading_id_6)
    1. [10.2 Using cross-origin resource sharing](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_17.html#heading_id_7)
        1. [10.2.1 How does CORS work?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_17.html#heading_id_8)
        1. [10.2.2 Applying CORS policies with the @CrossOrigin annotation](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_17.html#heading_id_9)
        1. [10.2.3 Applying CORS using a CorsConfigurer](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_17.html#heading_id_10)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_17.html#heading_id_11)
1. [11 Hands-on: A separation of responsibilities](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html)
    1. [11.1 The scenario and requirements of the example](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_3)
    1. [11.2 Implementing and using tokens](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_4)
        1. [11.2.1 What is a token?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_5)
        1. [11.2.2 What is a JSON Web Token?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_6)
    1. [11.3 Implementing the authentication server](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_7)
    1. [11.4 Implementing the business logic server](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_8)
        1. [11.4.1 Implementing the Authentication objects](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_9)
        1. [11.4.2 Implementing the proxy to the authentication server](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_10)
        1. [11.4.3 Implementing the AuthenticationProvider interface](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_11)
        1. [11.4.4 Implementing the filters](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_12)
        1. [11.4.5 Writing the security configurations](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_13)
        1. [11.4.6 Testing the whole system](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_14)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_18.html#heading_id_15)
1. [12 How does OAuth 2 work?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html)
    1. [12.1 The OAuth 2 framework](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_3)
    1. [12.2 The components of the OAuth 2 authentication architecture](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_4)
    1. [12.3 Implementation choices with OAuth 2](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_5)
        1. [12.3.1 Implementing the authorization code grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_6)
            1. [Step 1: Making the authentication request with the authorization code grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_7)
            1. [Step 2: Obtaining an access token with the authorization code grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_8)
            1. [Step 3: Calling the protected resource with the authorization code grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_9)
            1. [An analogy for the grant type authorization code](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_10)
        1. [12.3.2 Implementing the password grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_11)
            1. [Step 1: Requesting an access token when using the password grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_12)
            1. [Step 2: Using an access token to call resources when using the password grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_13)
            1. [An analogy for the password grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_14)
        1. [12.3.3 Implementing the client credentials grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_15)
            1. [Step 1: Requesting an access token with the client credential grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_16)
            1. [Step 2: Using an access token to call resources with the client credential grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_17)
        1. [12.3.4 Using refresh tokens to obtain new access tokens](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_18)
    1. [12.4 The sins of OAuth 2](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_19)
    1. [12.5 Implementing a simple single sign-on application](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_20)
        1. [12.5.1 Managing the authorization server](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_21)
        1. [12.5.2 Starting the implementation](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_22)
        1. [12.5.3 Implementing ClientRegistration](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_23)
        1. [12.5.4 Implementing ClientRegistrationRepository](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_24)
        1. [12.5.5 The pure magic of Spring Boot configuration](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_25)
        1. [12.5.6 Obtaining details about an authenticated user](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_26)
        1. [12.5.7 Testing the application](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_27)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_19.html#heading_id_28)
1. [13 OAuth 2: Implementing the authorization server](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_20.html)
    1. [13.1 Writing your own authorization server implementation](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_20.html#heading_id_3)
    1. [13.2 Defining user management](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_20.html#heading_id_4)
    1. [13.3 Registering clients with the authorization server](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_20.html#heading_id_5)
    1. [13.4 Using the password grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_20.html#heading_id_6)
    1. [13.5 Using the authorization code grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_20.html#heading_id_7)
    1. [13.6 Using the client credentials grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_20.html#heading_id_8)
    1. [13.7 Using the refresh token grant type](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_20.html#heading_id_9)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_20.html#heading_id_10)
1. [14 OAuth 2: Implementing the resource server](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_21.html)
    1. [14.1 Implementing a resource server](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_21.html#heading_id_3)
    1. [14.2 Checking the token remotely](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_21.html#heading_id_4)
    1. [14.3 Implementing blackboarding with a JdbcTokenStore](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_21.html#heading_id_5)
    1. [14.4 A short comparison of approaches](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_21.html#heading_id_6)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_21.html#heading_id_7)
1. [15 OAuth 2: Using JWT and cryptographic signatures](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html)
    1. [15.1 Using tokens signed with symmetric keys with JWT](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_3)
        1. [15.1.1 Using JWTs](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_4)
        1. [15.1.2 Implementing an authorization server to issue JWTs](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_5)
        1. [15.1.3 Implementing a resource server that uses JWT](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_6)
    1. [15.2 Using tokens signed with asymmetric keys with JWT](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_7)
        1. [15.2.1 Generating the key pair](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_8)
            1. [Generating a private key](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_9)
            1. [Obtaining the public key](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_10)
        1. [15.2.2 Implementing an authorization server that uses private keys](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_11)
        1. [15.2.3 Implementing a resource server that uses public keys](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_12)
        1. [15.2.4 Using an endpoint to expose the public key](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_13)
    1. [15.3 Adding custom details to the JWT](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_14)
        1. [15.3.1 Configuring the authorization server to add custom details to tokens](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_15)
        1. [15.3.2 Configuring the resource server to read the custom details of a JWT](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_16)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_22.html#heading_id_17)
1. [16 Global method security: Pre- and postauthorizations](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_23.html)
    1. [16.1 Enabling global method security](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_23.html#heading_id_3)
        1. [16.1.1 Understanding call authorization](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_23.html#heading_id_4)
            1. [Using preauthorization to secure access to methods](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_23.html#heading_id_5)
            1. [Using postauthorization to secure a method call](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_23.html#heading_id_6)
        1. [16.1.2 Enabling global method security in your project](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_23.html#heading_id_7)
    1. [16.2 Applying preauthorization for authorities and roles](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_23.html#heading_id_8)
    1. [16.3 Applying postauthorization](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_23.html#heading_id_9)
    1. [16.4 Implementing permissions for methods](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_23.html#heading_id_10)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_23.html#heading_id_11)
1. [17 Global method security: Pre- and postfiltering](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_24.html)
    1. [17.1 Applying prefiltering for method authorization](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_24.html#heading_id_3)
    1. [17.2 Applying postfiltering for method authorization](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_24.html#heading_id_4)
    1. [17.3 Using filtering in Spring Data repositories](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_24.html#heading_id_5)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_24.html#heading_id_6)
1. [18 Hands-on: An OAuth 2 application](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html)
    1. [18.1 The application scenario](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html#heading_id_3)
    1. [18.2 Configuring Keycloak as an authorization server](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html#heading_id_4)
        1. [18.2.1 Registering a client for our system](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html#heading_id_5)
        1. [18.2.2 Specifying client scopes](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html#heading_id_6)
        1. [18.2.3 Adding users and obtaining access tokens](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html#heading_id_7)
        1. [18.2.4 Defining the user roles](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html#heading_id_8)
    1. [18.3 Implementing the resource server](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html#heading_id_9)
    1. [18.4 Testing the application](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html#heading_id_10)
        1. [18.4.1 Proving an authenticated user can only add a record for themself](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html#heading_id_11)
        1. [18.4.2 Proving that a user can only retrieve their own records](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html#heading_id_12)
        1. [18.4.3 Proving that only admins can delete records](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html#heading_id_13)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_25.html#heading_id_14)
1. [19 Spring Security for reactive apps](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_26.html)
    1. [19.1 What are reactive apps?](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_26.html#heading_id_3)
    1. [19.2 User management in reactive apps](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_26.html#heading_id_4)
    1. [19.3 Configuring authorization rules in reactive apps](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_26.html#heading_id_5)
        1. [19.3.1 Applying authorization at the endpoint layer in reactive apps](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_26.html#heading_id_6)
        1. [19.3.2 Using method security in reactive apps](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_26.html#heading_id_7)
    1. [19.4 Reactive apps and OAuth 2](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_26.html#heading_id_8)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_26.html#heading_id_9)
1. [20 Spring Security testing](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html)
    1. [20.1 Using mock users for tests](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html#heading_id_3)
    1. [20.2 Testing with users from a UserDetailsService](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html#heading_id_4)
    1. [20.3 Using custom Authentication objects for testing](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html#heading_id_5)
        1. [Step 1: Defining a custom annotation](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html#heading_id_6)
        1. [Step 2: Creating a factory class for the mock SecurityContext](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html#heading_id_7)
        1. [Step 3: Linking the custom annotation to the factory class](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html#heading_id_8)
    1. [20.4 Testing method security](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html#heading_id_9)
    1. [20.5 Testing authentication](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html#heading_id_10)
    1. [20.6 Testing CSRF configurations](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html#heading_id_11)
    1. [20.7 Testing CORS configurations](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html#heading_id_12)
    1. [20.8 Testing reactive Spring Security implementations](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html#heading_id_13)
    1. [Summary](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_27.html#heading_id_14)
1. [appendix A. Creating a Spring Boot project](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_28.html)
    1. [A.1 Creating a project with start.spring.io](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_28.html#heading_id_3)
    1. [A.2 Creating a project with the Spring Tool Suite (STS)](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_28.html#heading_id_4)
1. [index](https://ebookreading.net/view/book/Spring+Security+in+Action-EB9781617297731_29.html)
